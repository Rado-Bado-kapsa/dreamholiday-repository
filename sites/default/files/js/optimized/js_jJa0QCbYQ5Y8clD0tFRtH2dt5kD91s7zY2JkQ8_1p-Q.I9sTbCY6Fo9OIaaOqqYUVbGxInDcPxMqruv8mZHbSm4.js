/* Source and licensing information for the line(s) below can be found at https://www.dreamholiday.space/modules/imce/js/plugins/imce/imce.upload.js. */
(function(a,t,e){'use strict';e.bind('init',e.uploadInit=function(){if(e.hasPermission('upload_files')){e.addTbb('upload',{title:t.t('Upload'),permission:'upload_files',content:e.createUploadForm(),shortcut:'Ctrl+Alt+U',icon:'upload'})}});e.createUploadForm=function(){var i,o,l,a=e.uploadForm,n='files[imce][]';if(a){return a};a=e.uploadForm=e.createEl('<form class="imce-upload-form" method="post" enctype="multipart/form-data" accept-charset="UTF-8"><div class="imce-form-item imce-form-file"><label>'+t.t('File')+'</label><input type="file" name="'+n+'" class="imce-file-input" multiple /></div><div class="imce-form-actions"><button type="submit" name="op" class="imce-upload-button">'+t.t('Upload')+'</button></div><input type="hidden" name="jsop" value="upload" /><input type="hidden" name="token" /></form>');a.action=e.getConf('ajax_url');i=a.elements;i.token.value=e.getConf('token');o=i[n];l=e.getConf('extensions','');if(l!=='*'){o.accept='.'+l.replace(/\s+/g,',.')};if(e.canAjaxUpload()){e.activeUq=new e.UploadQueue({name:n,accept:o.accept});a.insertBefore(e.activeUq.el,a.firstChild);a.className+=' uq';if(e.getConf('upload_auto_start',1)){a.className+=' auto-start'};a.onsubmit=e.eUploadQueueSubmit}
else{a.setAttribute('target','imce_upload_iframe');a.appendChild(e.createEl('<input type="hidden" name="active_path" />'));a.appendChild(e.createEl('<input type="hidden" name="return_html" value="1" />'));a.onsubmit=e.eUploadIframeSubmit};return a};e.eUploadQueueSubmit=function(a){e.activeUq.start();return!1};e.eUploadIframeSubmit=function(a){if(!e.validateUploadForm(this)){return!1};e.createUploadIframe();this.elements.active_path.value=e.activeFolder.getPath();e.uploadSetBusy(!0)};e.validateUploadForm=function(a){var o,t,i=a.elements['files[imce][]'],l=i.files;if(l){if(!l.length){return!1};for(o=0;t=l[o];o++){if(!e.validateFileUpload(t)){return!1}};return!0};if(i.value){t={name:i.value.split(i.value.indexOf('/')===-1?'\\':'/').pop()};return e.validateFileUpload(t)};return!1};e.validateFileUpload=function(i){var l=e.getConf('extensions','');if(l!=='*'&&!e.validateExtension(e.getExt(i.name),l)){return!1};var o=e.getConf('maxsize');if(o&&i.size&&i.size>o){e.setMessage(t.t('%filename is %filesize exceeding the maximum file size of %maxsize.',{'%filename':i.name,'%filesize':e.formatSize(i.size),'%maxsize':e.formatSize(o)}));return!1};if(!e.validateFileName(i.name)){return!1};return a.inArray(!1,e.trigger('validateFileUpload',i))===-1};e.createUploadIframe=function(){var a=e.uploadIframe;if(!a){a=e.uploadIframe=e.createEl('<iframe name="imce_upload_iframe" class="imce-upload-iframe" style="position: absolute; top: -9999px; left: -9999px;" src="javascript: "></iframe>');document.body.appendChild(a);setTimeout(function(){a.onload=e.eUploadIframeLoad})};return a};e.eUploadIframeLoad=function(t){var i,r,o,l,n=this;try{o=n.contentDocument||n.contentWindow&&n.contentWindow.document;if(o){l=a(o.body);if(i=l.find('textarea').eq(0).val()){r=a.parseJSON(i)};l.empty()}}catch(u){e.delayError(u)};e.uploadIframeComplete(r,i)};e.uploadIframeComplete=function(a,i){if(a){e.ajaxProcessResponse(a);if(a.added){e.uploadResetInput(e.uploadForm.elements['files[imce][]']);e.getTbb('upload').closePopup()}}
else{e.setMessage(t.t('Invalid response received from the server.'));if(i){e.setMessage('<pre>'+t.checkPlain(i)+'</pre>')}};e.uploadSetBusy(!1)};e.uploadSetBusy=function(t){a('.imce-upload-button',e.uploadForm).toggleClass('busy',t)[0].disabled=t};e.canAjaxUpload=function(){var a=e.ajaxUploadSupport;if(a==null){try{a=!!(window.FormData&&(new XMLHttpRequest().upload))}catch(t){a=!1};e.ajaxUploadSupport=a};return a};e.uploadResetInput=function(e){if(a(e).val('').val()){var t=document.createElement('form'),i=e.parentNode;t.style.display='none';i.insertBefore(t,e);t.appendChild(e);t.reset();i.insertBefore(e,t);i.removeChild(t)}}})(jQuery,Drupal,imce);
/* Source and licensing information for the above line(s) can be found at https://www.dreamholiday.space/modules/imce/js/plugins/imce/imce.upload.js. */